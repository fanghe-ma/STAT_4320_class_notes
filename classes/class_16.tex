\section{Lecture 16}

\subsection{GLRT for submodels, cont'd}

\begin{example} (Hardy-Weinberg Equilibrium)
    An individuals has genotype $AA, Aa, aa$. Draw $n$ random observations and denote 
    \[
        N_{AA}, N_{Aa}, N_{aa}
    \]
    such that 
    \[
        N_{AA}+ N_{Aa}+ N_{aa} = n
    \]

    We model this with multinomial distribution with parameters $p_{AA}, p_{Aa}, p_{aa}$ where 
    \[
        p_{AA}+ p_{Aa}+ p_{aa} = 1
    \]
    Then 
    \[
        (N_{AA}, N_{Aa}, N_{aa}) \sim Multi(n, p_{AA}, p_{Aa}, p_{aa})
    \]
    This has PMF 
    \[
    P(N_1 = n_1, N_2 = n_2, N_3 = n_3)= \frac{n! p_1^{n_1} p_2^{n_2} p_3^{n_3}}{n_1 ! n_2 ! n_3 !}
    \]
    We want to test 
    \[
        H_0: p_1 = \theta^2, p_2 = 2 \theta (1 - \theta), p_3 = ( 1- \theta)^2
    \]
    vs 
    \[
        H_1: H_0 \text{ not true}
    \]
    Here, the reduced model is 
    \[
    \Omega_0 = \{ \theta \in (0, 1), P_1 = \theta^2, 2 \theta (1 - \theta), p_3 = (1 - \theta)^2\} 
    \]
    and 
    \[
        \Omega = \{ 
            (p_1, p_2, p_3): p_1 + p_2 + p_3 = 1 \} 
    \]
    Note 
    \[
        \dim \Omega_0 = 1, \dim \Omega = 2
    \]

    Under full model ($H_1$), denote 
    \[
        \hat{p}_1, \hat{p}_2, \hat{p}_3
    \]
    Under submodel, $(H_0)$, denote
    \[
        \hat{p}_{1, H_0}, \hat{p}_{2, H_0}, \hat{p_{3, H_0}}
    \]

    \textbf{1. Solve MLE for full model}
    \[
        \hat{p}_1 = \frac{n_1}{n}, \hat{p}_2 = \frac{n_2}{n}, \hat{p}_3 = \frac{n_3}{n}
    \]
    \textbf{2. Solve MLE for submodel}
    \begin{align*}
        l( \theta) & \propto \left( \theta^2 \right)^{n_1} \left( 2 \theta( 1- \theta) \right)^{n_2} (1 - \theta)^{2 n_3} \\
        & \propto \theta^{2 n_1 + n_2 } ( 1- \theta)^{n_2 + 2n_3}
    \end{align*}

    Setting $ \frac{\partial }{\partial \theta} \log l( \theta) = 0$, 
    \begin{align*}
        \hat{ \theta} &= \frac{2n_1 + n_2}{2n_1 + 2n_2 + 2n_3} \\
        &= \frac{2n_1 + n_2}{2n}
    \end{align*}

    Then, 
    \[
    \wedge = \left( \frac{\hat{p}_{1, H_0}}{\hat{p}_1} \right)^{n_1}
            \left( \frac{\hat{p}_{2, H_0}}{\hat{p}_2} \right)^{n_2}
            \left( \frac{\hat{p}_{3, H_0}}{\hat{p}_3} \right)^{n_3}
    \]
    and under $H_0$
    \[
        -2 \log \wedge = 
        2n_1 \log \left( \frac{\hat{p}_1}{\hat{p}_{1, H_0}} \right)  + 
        2n_2 \log \left( \frac{\hat{p}_2}{\hat{p}_{2, H_0}} \right)  + 
        2n_3 \log \left( \frac{\hat{p}_3}{\hat{p}_{3, H_0}} \right)  \overset{d}{\longrightarrow} \chi_1^2
    \]
    
     
\end{example}

\begin{example} (Two sample t-test, equal variances)
    Suppose $X_1, \hdots X_m \sim N(\mu_1, \sigma^2), Y_1, \hdots Y_n \sim N(\mu_2, \sigma^2)$, $\sigma^2$ unknown. 

    Test 
    \[
        H_0: \mu_1 = \mu_2 \text{ vs } H_1: \mu_1 \neq \mu_2
    \]

    The likelihood function is 
    \[
        L(\mu_1, \mu_2, \sigma^2 | X_1, \hdots X_m, Y_1, \hdots Y_n) = 
        \left( \frac{1}{\sqrt{2 \pi \sigma} } \right)^m \exp{
            -\frac{1}{2 \sigma^2}
            \sum\limits_{i = 1}^{m}  (X_i - \mu_1)^2
        }
        \left( \frac{1}{\sqrt{2 \pi \sigma} } \right)^n \exp{
            -\frac{1}{2 \sigma^2}
            \sum\limits_{i = 1}^{m}  (Y_i - \mu_2)^2
        }
    \]

    The GLRT is based on 
    \[
        \wedge = \frac{
            \max_{\mu, \sigma^2} L(\mu, \mu, \sigma^2 | \bm{X}, \bm{Y})
        }{
            \max_{\mu_1, \mu_2, \sigma^2} L(\mu_1, \mu_2, \sigma^2 | \bm{X}, \bm{Y})
        }
    \]

    Rejecting $H_0$ for small values of $\wedge$ is equivalent to rejecting for large values of 
    \[
        \left| \frac{\bar{X} - \bar{Y} }{s_P \sqrt{ \frac{1}{m} + \frac{1}{n}}} \right| 
    \]

    Where $s_p^2$ is the pooled sample variance
    \[
        s_p^2 = \frac{1}{n + m - 2} \{ \sum\limits_{i = 1}^{m} (X_i - \bar{X} )^2 + \sum\limits_{j = 1}^{m} (X_j - \bar{Y} )^2 \} 
    \]

    Note that 
    \[
        \sum\limits_{i = 1}^{m} (X_i - \bar{X} )^2 \sim \sigma \chi_{m - 1}^2
    \]
    \[
        \sum\limits_{j = 1}^{n} (Y_i - \bar{Y} )^2 \sim \sigma \chi_{n - 1}^2
    \]

    And the following are independent.
    \[
        \bar{X} , \bar{Y} , \sum\limits_{i =1}^{m} (X_i - \bar{X} )^2, \sum\limits_{j = 1}^{n} (Y_j - \bar{Y} )^2
    \]

    Under $H_0$, 
    \[
        \frac{\bar{X} - \bar{Y}  }{ \sqrt{ \frac{\sigma^2}{m} + \frac{\sigma^2}{n}}} \sim N(0, 1)
    \]

    and 
    \[
        \frac{s_p^2}{\sigma^2} \sim \frac{\chi_{m + n - 2}^2}{m + n - 2}
    \]
    Hence 
    \[
        T = \frac{\bar{X} - \bar{Y} }{s_p \sqrt{ \frac{1}{m} + \frac{1}{n}}} \sim t_{n + m - 2}
    \]
    The GLRT level $\alpha$ test rejects when 
    \[
        \left| T \right|  \geq t_{m+ n - 2, \alpha / 2}
    \]
    
\end{example}

\begin{example} (Two sample t-test, unequal variances)
\end{example}